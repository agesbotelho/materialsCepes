/***
* Scripts para criaacao e insersao de dados
* Base de Dados do CePES Material 
* Casssio Trindade
* 09/09/2015
***/

USE cepes_e;


-- Tabela usuarios e asuario de adm
CREATE TABLE tb_usuario (
  ID_USUARIO int(11) NOT NULL AUTO_INCREMENT,
  USUARIO varchar(45) NOT NULL,
  SENHA varchar(45) NOT NULL,
  ADMINISTRADOR varchar(1) DEFAULT NULL,
  MATRICULA varchar(45) NOT NULL,
  NOME varchar(120) DEFAULT NULL,
  EMAIL varchar(120) DEFAULT NULL,
  DATA_CADASTRO datetime DEFAULT NULL,
  PRIMARY KEY (ID_USUARIO,MATRICULA),
  UNIQUE KEY MATRICULA_UNIQUE (MATRICULA)
) ENGINE=InnoDB AUTO_INCREMENT=19 DEFAULT CHARSET=utf8;

INSERT INTO tb_usuario
(ID_USUARIO,USUARIO,SENHA,ADMINISTRADOR,MATRICULA,NOME,EMAIL,DATA_CADASTRO)
VALUES
('10', 'admin', 'admin', 'S', '00000', 'Cássio Trindade', 'cassio.trindade@pucrs.br', '2015-10-01 00:00:00');

   
CREATE TABLE tb_autor (
  id_autor int(11) NOT NULL AUTO_INCREMENT,
  nome varchar(60) NOT NULL,
  sobrenome varchar(60) NOT NULL,
  PRIMARY KEY (id_autor)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE tb_livro (
  ID_LIVRO int(8) NOT NULL AUTO_INCREMENT,
  TITULO varchar(255) NOT NULL,
  SUBTITULO varchar(255) NOT NULL,
  DATA_CADASTRO date NOT NULL,
  PRECO decimal(8,0) DEFAULT NULL,
  LINGUA varchar(255) NOT NULL,
  CODIGO_ISBN decimal(20,0) NOT NULL,
  EDICAO decimal(4,0) NOT NULL,
  ANO date DEFAULT NULL,
  PAGINAS int(4) DEFAULT NULL,
  VIDEO tinyint(1) DEFAULT NULL,
  CD_DVD tinyint(1) DEFAULT NULL,
  E_BOOK tinyint(1) DEFAULT NULL,
  DESCRICAO text,
  ID_EDITORA int(11) DEFAULT NULL,
  PRIMARY KEY (ID_LIVRO),
  UNIQUE KEY CODISBN_UNIQUE (CODIGO_ISBN)
) ENGINE=InnoDB AUTO_INCREMENT=19 DEFAULT CHARSET=utf8;

CREATE TABLE tb_editora (
  ID_EDITORA int(8) NOT NULL AUTO_INCREMENT,
  NOME varchar(255) NOT NULL,
  PRIMARY KEY (ID_EDITORA)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE tb_livro (
  ID_LIVRO int(8) NOT NULL AUTO_INCREMENT,
  TITULO varchar(255) NOT NULL,
  SUBTITULO varchar(255) NOT NULL,
  DATA_CADASTRO date NOT NULL,
  PRECO decimal(8,0) DEFAULT NULL,
  LINGUA varchar(255) NOT NULL,
  CODIGO_ISBN decimal(20,0) NOT NULL,
  EDICAO decimal(4,0) NOT NULL,
  ANO date DEFAULT NULL,
  PAGINAS int(4) DEFAULT NULL,
  VIDEO tinyint(1) DEFAULT NULL,
  CD_DVD tinyint(1) DEFAULT NULL,
  E_BOOK tinyint(1) DEFAULT NULL,
  DESCRICAO text,
  ID_EDITORA int(11) DEFAULT NULL,
  PRIMARY KEY (ID_LIVRO),
  UNIQUE KEY CODISBN_UNIQUE (CODIGO_ISBN)
) ENGINE=InnoDB AUTO_INCREMENT=19 DEFAULT CHARSET=utf8;

CREATE TABLE tb_livro_autor (
  id_livro int(11) NOT NULL,
  id_autor int(11) NOT NULL,
  KEY fk_livro_idx (id_livro),
  KEY fk_autor (id_autor),
  CONSTRAINT fk_autor FOREIGN KEY (id_autor) REFERENCES tb_autor (id_autor) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT fk_livro FOREIGN KEY (id_livro) REFERENCES tb_livro (ID_LIVRO) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

